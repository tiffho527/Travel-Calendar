<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trip Calendar - Collaborative</title>

<!-- FullCalendar CSS -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto&display=swap" rel="stylesheet">

<!-- Favicon -->
<link rel="icon" href="favicon.ico" type="image/x-icon">

<!-- Custom Styles -->
<link rel="stylesheet" href="styles.css">

<!-- Preload event data for faster initial load -->
<link rel="preload" href="events.json" as="fetch" crossorigin="anonymous">

<style>
/* Connection status indicator */
#connectionStatus {
  padding: 5px 12px;
  border-radius: 6px;
  font-size: 0.85rem;
  font-weight: 600;
  margin-left: auto;
}
.status-connecting {
  background: #ffd700;
  color: #333;
}
.status-connected {
  background: #4caf50;
  color: white;
}
.status-offline {
  background: #9e9e9e;
  color: white;
}
.status-reconnecting {
  background: #ff9800;
  color: white;
  animation: pulse 1.5s ease-in-out infinite;
}
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}
</style>
</head>
<body>

<header>
  <div class="header-left">
    <h1>ğŸŒ My Trip Calendar</h1>
  </div>

  <div class="header-center">
    <button id="addEventBtn" class="btn-primary">+ Add Event</button>

    <div id="viewControls" class="view-controls">
      <div class="button-group">
        <button id="monthViewBtn" class="active">Month</button>
        <button id="weekViewBtn">Week</button>
        <button id="dayViewBtn">Day</button>
      </div>
      <button id="toggleViewBtn" class="btn-toggle">ğŸ“… Toggle View</button>
    </div>
  </div>

  <div class="header-right">
    <div id="connectionStatus" class="status-connecting">ğŸ”„ Connecting...</div>
    <button id="actionsMenuBtn" class="btn-actions" aria-label="Actions menu">
      <span class="hamburger-icon">â˜°</span>
    </button>
  </div>

  <input type="file" id="importFile" accept=".json" style="display:none;">
</header>

<!-- Actions Dropdown Menu -->
<div id="actionsMenu" class="actions-menu">
  <button id="exportBtn" class="menu-item">ğŸ“¤ Export Events</button>
  <button id="importBtn" class="menu-item">ğŸ“¥ Import Events</button>
  <button id="resetEventsBtn" class="menu-item">ğŸ”„ Reset Events</button>
  <hr class="menu-divider">
  <button id="localModeBtn" class="menu-item">ğŸ“´ Switch to Local Mode</button>
</div>

<div id="calendar"></div>
<div id="listView"></div>

<!-- Event Modal -->
<div id="eventModal">
  <div class="modal-content">
    <span id="modalClose">âœ–</span>
    <h2>Add Event</h2>
    <input type="text" id="eventTitle" placeholder="Title">
    <input type="datetime-local" id="eventStart" placeholder="Start Time">
    <input type="datetime-local" id="eventEnd" placeholder="End Time">
    <input type="text" id="eventAddress" placeholder="Address">
    <h3>Notes</h3>
    <input type="text" id="noteReservation" placeholder="Reservation">
    <input type="text" id="noteCost" placeholder="Cost">
    <input type="text" id="noteDirections" placeholder="Directions">
    <input type="text" id="noteLinks" placeholder="Links, comma separated">
    <input type="file" id="notePhotos" multiple>
    <div id="photoPreview"></div>
    <div id="travelNext"></div>
    <button id="saveEvent">Save Event</button>
    <button id="deleteEvent" style="background:red; color:white;">Delete Event</button>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<!-- Firebase Configuration - INLINE (no external file issues!) -->
<script>
const firebaseConfig = {
  apiKey: "AIzaSyB_AFUna3VXO4eSwYDFyixg38QWgaHC5K0",
  authDomain: "trip-calendar-4f14e.firebaseapp.com",
  databaseURL: "https://trip-calendar-4f14e-default-rtdb.firebaseio.com",
  projectId: "trip-calendar-4f14e",
  storageBucket: "trip-calendar-4f14e.firebasestorage.app",
  messagingSenderId: "214310496442",
  appId: "1:214310496442:web:f3646a0f4c1eb815607a83"
};

let database;

function initFirebase() {
  if (typeof firebase === 'undefined') {
    console.log('Firebase SDK not loaded');
    return false;
  }
  if (!firebaseConfig.apiKey) {
    console.log('Firebase not configured');
    return false;
  }
  try {
    firebase.initializeApp(firebaseConfig);
    database = firebase.database();
    console.log('âœ… Firebase initialized successfully');
    return true;
  } catch (error) {
    console.log('Firebase initialization failed:', error.message);
    return false;
  }
}

if (typeof module !== 'undefined' && module.exports) {
  module.exports = { initFirebase, firebaseConfig };
}
</script>

<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

<!-- Custom Collaborative Script -->
<script src="script.js"></script>

</body>
</html>

